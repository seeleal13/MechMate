{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
    <h2>Add Vehicle</h2>
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category }}">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}
    <form method="POST">
        {{ form.hidden_tag() }}
        <div class="form-group">
            {{ form.make.label }} 
            {{ form.make(class="form-control make-select") }}
            {{ form.use_custom_make(id="use_custom_make") }} {{ form.use_custom_make.label }}
            {{ form.custom_make(class="form-control mt-2 custom-make-input", style="display: none;", disabled=True, placeholder="Enter custom make") }}
        </div>
        <div class="form-group">
            {{ form.model.label }} 
            {{ form.model(class="form-control model-select", style="display: block;") }}
            {{ form.custom_model(class="form-control mt-2 custom-model-input", style="display: none;", disabled=True, placeholder="Enter custom model") }}
        </div>
        <div class="form-group">
            {{ form.year.label }} 
            {{ form.year(class="form-control year-select", style="display: block;") }}
            {{ form.custom_year(class="form-control mt-2 custom-year-input", style="display: none;", disabled=True, placeholder="Enter custom year") }}
        </div>
        <div class="form-group">
            {{ form.license_plate.label }} 
            {{ form.license_plate(class="form-control", placeholder="Enter license plate") }}
        </div>
        {{ form.submit(class="btn btn-primary mt-3") }}
    </form>
    <a href="{{ url_for('dashboard') }}" class="btn btn-secondary mt-3">Back to Dashboard</a>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const checkbox = document.getElementById('use_custom_make');
    const makeSelect = document.querySelector('.make-select');
    const customMakeInput = document.querySelector('.custom-make-input');
    const modelSelect = document.querySelector('.model-select');
    const customModelInput = document.querySelector('.custom-model-input');
    const yearSelect = document.querySelector('.year-select');
    const customYearInput = document.querySelector('.custom-year-input');

    const updateFields = () => {
        if (checkbox.checked) {
            makeSelect.style.display = 'none';
            makeSelect.disabled = true;
            customMakeInput.style.display = 'block';
            customMakeInput.disabled = false;
            modelSelect.style.display = 'none';
            modelSelect.disabled = true;
            customModelInput.style.display = 'block';
            customModelInput.disabled = false;
            yearSelect.style.display = 'none';
            yearSelect.disabled = true;
            customYearInput.style.display = 'block';
            customYearInput.disabled = false;
        } else {
            makeSelect.style.display = 'block';
            makeSelect.disabled = false;
            customMakeInput.style.display = 'none';
            customMakeInput.disabled = true;
            modelSelect.style.display = 'block';
            modelSelect.disabled = false;
            customModelInput.style.display = 'none';
            customModelInput.disabled = true;
            yearSelect.style.display = 'block';
            yearSelect.disabled = false;
            customYearInput.style.display = 'none';
            customYearInput.disabled = true;
        }
    };

    checkbox.addEventListener('change', updateFields);
    updateFields(); // Initialize on page load
});
</script>
{% endblock %}